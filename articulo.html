<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title id="dynamic-title">Artículo - Barillas, Colindres & Asociados</title>
<meta name="description" id="dynamic-description" content="Consulta nuestros artículos legales especializados en derecho guatemalteco.">

<!-- Fuentes modernas -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

<style>
/* --- Tus estilos existentes (igual al bloque anterior) --- */
/* ... pega todo tu CSS aquí ... */
</style>
</head>
<body>
<header class="header-blog">
  <div class="header-content">
    <a href="index.html" class="logo-blog">
      <img src="images/logo.webp" alt="Logo" />
      <span class="logo-text">Barillas, Colindres & Asociados</span>
    </a>
    <nav class="nav-breadcrumb">
      <a href="index.html">Inicio</a> / <a href="index.html#blog">Blog</a> / <span id="breadcrumb-title">Artículo</span>
    </nav>
  </div>
</header>

<div class="contenedor">
  <article class="article-container">
    <header class="article-header">
      <div class="article-meta" id="article-meta">
        <div class="meta-item">
          <i class="fas fa-calendar"></i>
          <span id="article-date">Cargando...</span>
        </div>
        <div class="meta-item">
          <i class="fas fa-user"></i>
          <span>Barillas, Colindres & Asociados</span>
        </div>
        <div class="meta-item">
          <i class="fas fa-clock"></i>
          <span id="reading-time">5 min lectura</span>
        </div>
      </div>
      <h1 class="article-title" id="article-title">Cargando artículo...</h1>
    </header>
    
    <div class="article-content">
      <div id="contenido-articulo" class="loading">
        <div></div>
        <p>Cargando contenido del artículo...</p>
      </div>
    </div>
    
    <footer class="article-navigation">
      <a href="index.html#blog" class="btn-back">
        <i class="fas fa-arrow-left"></i>
        Volver al blog
      </a>
      <div class="social-share">
        <a href="#" class="share-btn facebook" onclick="compartirFacebook()" title="Compartir en Facebook"><i class="fab fa-facebook-f"></i></a>
        <a href="#" class="share-btn twitter" onclick="compartirTwitter()" title="Compartir en Twitter"><i class="fab fa-twitter"></i></a>
        <a href="#" class="share-btn linkedin" onclick="compartirLinkedIn()" title="Compartir en LinkedIn"><i class="fab fa-linkedin-in"></i></a>
        <a href="#" class="share-btn whatsapp" onclick="compartirWhatsApp()" title="Compartir en WhatsApp"><i class="fab fa-whatsapp"></i></a>
      </div>
    </footer>
  </article>
</div>

<script>
// ===================== Utilidades =====================
function obtenerParametro(nombre) {
  const params = new URLSearchParams(window.location.search);
  const valor = params.get(nombre);
  return valor ? decodeURIComponent(valor) : null;
}

function estimarTiempoLectura(texto) {
  const palabrasPorMinuto = 200;
  const palabras = texto.trim().split(/\s+/).length;
  const minutos = Math.ceil(palabras / palabrasPorMinuto);
  return `${minutos} min lectura`;
}

function actualizarMetaTags(title, description) {
  document.title = `${title} - Barillas, Colindres & Asociados`;
  const metaDesc = document.getElementById('dynamic-description');
  if (metaDesc) metaDesc.content = description || `${title} - Artículo legal especializado`;
  const breadcrumb = document.getElementById('breadcrumb-title');
  if (breadcrumb) breadcrumb.textContent = title.length > 30 ? title.substring(0, 30) + '...' : title;
}

function mostrarError(mensaje, error = null) {
  const html = `
    <div class="error">
      <i class="fas fa-exclamation-triangle"></i>
      <h3>${mensaje}</h3>
      ${error ? `<p><small>Error: ${error.message}</small></p>` : ""}
    </div>
  `;
  document.getElementById("contenido-articulo").innerHTML = html;
  document.getElementById("contenido-articulo").className = "";
}

// ===================== Compartir =====================
function compartirFacebook() {
  const url = encodeURIComponent(window.location.href);
  const title = encodeURIComponent(document.getElementById('article-title').textContent);
  window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${title}`, '_blank', 'width=600,height=400');
}
function compartirTwitter() {
  const url = encodeURIComponent(window.location.href);
  const title = encodeURIComponent(document.getElementById('article-title').textContent);
  window.open(`https://twitter.com/intent/tweet?url=${url}&text=${title}`, '_blank', 'width=600,height=400');
}
function compartirLinkedIn() {
  const url = encodeURIComponent(window.location.href);
  window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank', 'width=600,height=400');
}
function compartirWhatsApp() {
  const url = encodeURIComponent(window.location.href);
  const title = encodeURIComponent(document.getElementById('article-title').textContent);
  window.open(`https://wa.me/?text=${title} ${url}`, '_blank');
}

// ===================== Cargar artículo =====================
function cargarArticulo(archivo) {
  if (!archivo) {
    mostrarError("No se especificó ningún artículo");
    return;
  }
  const urlArchivo = encodeURI(archivo);
  fetch(urlArchivo)
    .then(res => { if (!res.ok) throw new Error(`HTTP ${res.status}`); return res.text(); })
    .then(md => procesarMarkdown(md))
    .catch(error => mostrarError("No se pudo cargar el artículo", error));
}

function procesarMarkdown(md) {
  const frontmatterMatch = md.match(/^---\s*([\s\S]*?)\s*---/);
  let frontmatter = {};
  if (frontmatterMatch) {
    frontmatterMatch[1].split('\n').forEach(line => {
      const match = line.match(/^(\w+):\s*(.*)$/);
      if (match) frontmatter[match[1]] = match[2].replace(/^['"]|['"]$/g, "");
    });
  }

  const contenido = md.replace(/^---[\s\S]*?---/, "").trim();
  const title = frontmatter.title || "Artículo Legal";
  const fecha = frontmatter.date || new Date().toLocaleDateString('es-GT');

  document.getElementById('article-title').textContent = title;
  document.getElementById('article-date').textContent = fecha;
  document.getElementById('reading-time').textContent = estimarTiempoLectura(contenido);
  actualizarMetaTags(title, frontmatter.description);
  document.getElementById("contenido-articulo").innerHTML = marked.parse(contenido);
  document.getElementById("contenido-articulo").className = "";
}
  // ===================== Generar JSON-LD dinámico =====================
function generarJSONLD(articulo, indexData) {
  // Buscar el artículo en el index.json
  const info = indexData.find(a => a.archivo === articulo);
  if (!info) return;

  const jsonld = {
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": info.title,
    "alternativeHeadline": info.title,
    "image": info.image || "https://consultoria-legal-guatemala.netlify.app/img/logo-colindres-aqua.png",
    "editor": "Colindres Barillas & Asociados",
    "genre": info.category,
    "keywords": info.keywords,
    "wordcount": info.wordcount || "",
    "url": info.url,
    "datePublished": info.date,
    "dateModified": info.date,
    "description": info.description,
    "author": {
      "@type": "Organization",
      "name": "Colindres Barillas & Asociados"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Colindres Barillas & Asociados",
      "logo": {
        "@type": "ImageObject",
        "url": "https://consultoria-legal-guatemala.netlify.app/img/logo-colindres-aqua.png"
      }
    }
  };

  const script = document.createElement('script');
  script.type = "application/ld+json";
  script.textContent = JSON.stringify(jsonld, null, 2);
  document.head.appendChild(script);
}

// ===================== Cargar index.json y generar JSON-LD =====================
fetch('script/index.json') // ajusta la ruta si lo tienes en otra carpeta
  .then(res => res.json())
  .then(data => generarJSONLD(archivo, data))
  .catch(err => console.error("No se pudo cargar index.json para JSON-LD", err));


// ===================== Inicializar =====================
const archivo = obtenerParametro("archivo");
cargarArticulo(archivo);

// Scroll header
window.addEventListener('scroll', () => {
  const header = document.querySelector('.header-blog');
  header.style.background = window.scrollY > 50 ? 'rgba(0,0,0,0.95)' : 'rgba(0,0,0,0.9)';
});
</script>
</body>
</html>






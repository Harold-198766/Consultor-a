<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" id="dynamic-description" content="Artículo legal especializado" />
  <title>Artículo - Barillas, Colindres & Asociados</title>
  <link rel="stylesheet" href="estilos.css" />
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
  <header>
    <div class="logo">
      <img src="logo.png" alt="Logo del bufete" />
      <h1>Asesoría Jurídica Profesional</h1>
    </div>
    <nav>
      <a href="index.html">Inicio</a>
      <a href="blog.html">Blog</a>
      <a href="contacto.html">Contacto</a>
    </nav>
  </header>

  <main class="contenido-principal">
    <section class="articulo">
      <h1 id="article-title"></h1>
      <p id="article-date" class="fecha-articulo"></p>
      <p id="reading-time" class="tiempo-lectura"></p>

      <div id="contenido-articulo" class="contenido-markdown"></div>

      <div class="compartir">
        <p>Compartir:</p>
        <button onclick="compartirFacebook()">Facebook</button>
        <button onclick="compartirTwitter()">Twitter</button>
        <button onclick="compartirLinkedIn()">LinkedIn</button>
        <button onclick="compartirWhatsApp()">WhatsApp</button>
      </div>

      <a href="blog.html" class="btn-volver">← Volver al blog</a>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Barillas, Colindres & Asociados. Todos los derechos reservados.</p>
  </footer>

  <script>
    function obtenerParametro(nombre) {
      const params = new URLSearchParams(window.location.search);
      return params.get(nombre);
    }

    function estimarTiempoLectura(texto) {
      const palabrasPorMinuto = 200;
      const palabras = texto.trim().split(/\s+/).length;
      const minutos = Math.ceil(palabras / palabrasPorMinuto);
      return `${minutos} min lectura`;
    }

    function actualizarMetaTags(title, description) {
      document.title = `${title} - Barillas, Colindres & Asociados`;
      const metaDesc = document.getElementById('dynamic-description');
      if (metaDesc) {
        metaDesc.content = description || `${title} - Artículo legal especializado`;
      }
    }

    function compartirFacebook() {
      const url = encodeURIComponent(window.location.href);
      const title = encodeURIComponent(document.getElementById('article-title').textContent);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${title}`, '_blank', 'width=600,height=400');
    }

    function compartirTwitter() {
      const url = encodeURIComponent(window.location.href);
      const title = encodeURIComponent(document.getElementById('article-title').textContent);
      window.open(`https://twitter.com/intent/tweet?url=${url}&text=${title}`, '_blank', 'width=600,height=400');
    }

    function compartirLinkedIn() {
      const url = encodeURIComponent(window.location.href);
      window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}`, '_blank', 'width=600,height=400');
    }

    function compartirWhatsApp() {
      const url = encodeURIComponent(window.location.href);
      const title = encodeURIComponent(document.getElementById('article-title').textContent);
      window.open(`https://wa.me/?text=${title} ${url}`, '_blank');
    }

    function cargarArticulo() {
      const archivo = obtenerParametro("archivo");
      const contenedor = document.getElementById("contenido-articulo");

      if (!archivo) {
        contenedor.innerHTML = "<p>No se especificó ningún artículo.</p>";
        return;
      }

      fetch('articulos/index.json')
        .then(res => res.json())
        .then(indexData => {
          console.log("Archivo solicitado:", archivo);
          console.log("Archivos disponibles:", indexData.map(a => a.archivo));

          const info = indexData.find(a =>
            a.archivo.trim().toLowerCase() === archivo.trim().toLowerCase()
          );

          if (!info) {
            contenedor.innerHTML = `
              <h2>Artículo no encontrado</h2>
              <p>Verifica que el nombre del archivo esté correcto o que el artículo haya sido publicado.</p>
              <a href="blog.html" class="btn-volver">← Volver al blog</a>
            `;
            return;
          }

          document.getElementById('article-title').textContent = info.title;

          const fecha = new Date(info.date);
          document.getElementById('article-date').textContent = fecha.toLocaleDateString('es-GT', {
            year: 'numeric', month: 'long', day: 'numeric'
          });

          document.getElementById('reading-time').textContent = estimarTiempoLectura(info.description);
          actualizarMetaTags(info.title, info.description);

          fetch('articulos/' + info.archivo)
            .then(res => {
              if (!res.ok) throw new Error("Archivo .md no encontrado en el servidor");
              return res.text();
            })
            .then(md => {
              const limpio = md.replace(/^---[\s\S]*?---/, "").trim();
              contenedor.innerHTML = marked.parse(limpio);
            })
            .catch(error => {
              contenedor.innerHTML = `<p>Error al cargar el contenido del artículo: ${error.message}</p>`;
            });
        })
        .catch(error => {
          contenedor.innerHTML = `<p>Error al cargar el índice de artículos: ${error.message}</p>`;
        });
    }

    cargarArticulo();
  </script>
</body>
</html>


